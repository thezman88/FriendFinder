<!DOCTYPE html>
<html lang="en">
<html>

<head>
  <meta charset="UTF-8">
  <!-- materialize -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <!-- materialize icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
  <!-- Compiled and minified JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

  <title>Friend Finder - Survey</title>
</head>

<body>
  <div class='container'>
    <div class='card-panel teal darken-1 col s12 center-align'>
      <h4><strong>Personality Questions</strong></h4>
      <div class='card-panel left-align white'>
        <h5><strong>About You</strong></h5>
        <br>
        <input id="name" type="text" class="checker" required>
        <label class='active' for="name">Name (required)</label>
        <input id="photo" type="text" class="checker" required>
        <label class='active' for="name">Link to Photo Image (required)</label>
        <h5>Question 1</h5>
        <p>You make friends easily.</p>
        <select data-placeholder="" class="browser-default" id="q1">
          <option value="">Choose an option</option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
        <h5>Question 2</h5>
        <p>You prefer variety to routine.</p>
        <select data-placeholder="" class="browser-default" id="q2">
          <option value="">Choose an option</option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
        <h5>Question 3</h5>
        <p>You are always on the go.</p>
        <select data-placeholder="" class="browser-default" id="q3">
          <option value="">Choose an option</option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
        <h5>Question 4</h5>
        <p>You are more of a detail-oriented than a big picture person.</p>
        <select data-placeholder="" class="browser-default" id="q4">
          <option value="">Choose an option</option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
        <h5>Question 5</h5>
        <p>You can stay calm under a lot of pressure.</p>
        <select data-placeholder="" class="browser-default" id="q5">
          <option value="">Choose an option</option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
        <h5>Question 6</h5>
        <p>You believe in the importance of art.</p>
        <select data-placeholder="" class="browser-default" id="q6">
          <option value="">Choose an Option</option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
        <h5>Question 7</h5>
        <p>You see yourself as sympathetic.</p>
        <select data-placeholder="" class="browser-default" id="q7">
          <option value="">Choose an option</option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
        <h5>Question 8</h5>
        <p>You see yourself as disorganized.</p>
        <select data-placeholder="" class="browser-default" id="q8">
          <option value="">Choose an option</option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
        <h5>Question 9</h5>
        <p>You see yourself as calm, emotionally stable.</p>
        <select data-placeholder="" class="browser-default" id="q9">
          <option value="">Choose an option</option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
        <h5>Question 10</h5>
        <p>You see yourself as practical, conventional.</p>
        <select data-placeholder="" class="browser-default" id="q10">
          <option value="">Choose an option</option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
        <br>
        <!-- Materialize Modal Trigger/Submit Button -->
        <button type="submit" data-target="modal1" class="waves-effect waves-light btn modal-trigger orange darken-1" id="submitBtn">Submit</button>
      </div>
    </div>
    <div class='col s4'>
      <p><a href='/api/friends'>API Friends List</a> | <a href='https://github.com/thezman88/friendFinder' target='_blank'>GitHub Repo</a></p>
    </div>

    <!-- Materialize Modal Structure -->
    <div id="modal1" class="modal">
      <div class="modal-content">
        <h4>Your new friend!</h4>
        <h5 id="matchName"></h5>
        <img id="matchPic" src="" alt="No Image" width=250px>
      </div>
      <div class="modal-footer">
        <a href="#!" class=" modal-action modal-close  btn-flat">Done</a>
      </div>
    </div>

  </div>

  <!-- Grabs information and sends it to server -->
  <script type="text/javascript">
    $(document).ready(function() {
      $("#submitBtn").on("click", function() {
        //form validation
        function FormChecker() {
          var isValid = true;
          $('.checker').each(function() {
            if ($(this).val() === '') {
              isValid = false;
            }
          });
          $('.browser-default').each(function() {
            if ($(this).val() === "") {
              isValid = false;
            }
          });
          return isValid;
        }
        //if everything is filled
        if (FormChecker() == true) {
          //creates a new friend from the values submitted
          var newFriend = {
            name: $('#name').val().trim(),
            profilePic: $('#photo').val().trim(),
            scores: [
              $('#q1').val(),
              $('#q2').val(),
              $('#q3').val(),
              $('#q4').val(),
              $('#q5').val(),
              $('#q6').val(),
              $('#q7').val(),
              $('#q8').val(),
              $('#q9').val(),
              $('#q10').val(),
            ]
          };
          //Grabs current URL of website
          var currentURL = window.location.origin;
          //AJAX posts the data to friends API.
          $.post(currentURL + "/api/friends", newFriend, function(data) {
            //Grab the result from the AJAX post so that the best match's name and photo are displayed.
            $("#matchName").text(data.name);
            $("#matchPic").attr("src", data.profilePic);
          });
          // Show the modal with the best match
          $('.modal').modal();
          //clear form after submission
          $('#name').val("");
          $('#photo').val("");
          $('#q1').val("");
          $('#q2').val("");
          $('#q3').val("");
          $('#q4').val("");
          $('#q5').val("");
          $('#q6').val("");
          $('#q7').val("");
          $('#q8').val("");
          $('#q9').val("");
          $('#q10').val("");
        } else {
          alert("All fields are required to be filled for submission")
        }
        // return false;
      });
    });
  </script>
</body>

</html>
